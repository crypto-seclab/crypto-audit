# Copyright (c) 2025 Crypto Security Labs
#
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.
#
# SPDX-License-Identifier: MPL-2.0

policyId: "FIPS-140-2"
version: "2025-08-01"
rules:
  - id: "MD-FIPS-1"
    api: "java.security.MessageDigest.getInstance"
    algorithms:
      allowRegex:
        - "(?i)^SHA.*"
      deny:
        - "MD5"
        - "SHA"
    providers:
      allow:
        - "BCFIPS"
  - id: "AES-FIPS-1"
    api: "javax.crypto.Cipher.getInstance"
    algorithms:
      allowRegex:
        - "(?i)^AES/(ECB|CBC|CFB8|CFB128|OFB|CTR|CCM|GCM/FF1)(/[^/]+)?$"
        - "(?i)^DESede/(ECB|CBC|CFB8|CFB64|OFB|CTR)(/[^/]+)?$"
    providers:
      allow:
        - "BCFIPS"
  - id: "SR-FIPS-1"
    api: "java.security.SecureRandom.getInstance"
  - id: "SR-FIPS-2"
    api: "java.security.SecureRandom.getInstanceStrong"
